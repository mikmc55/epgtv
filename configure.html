<!DOCTYPE html>
<html style="background-image: url(<%=MANIFEST.background%>);">
<head>
   <meta charset="utf-8">
   <title>Your IPTV - Stremio Addon</title>
   <link rel="shortcut icon" href="<%=MANIFEST.logo%>" type="image/x-icon">
   <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap" rel="stylesheet">
   <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
   <style>
* {
   box-sizing: border-box;
}

body,
html {
   margin: 0;
}

html {
   background-size: auto 100%;
   background-size: cover;
   background-position: center center;
   background-repeat: repeat-y;
}

body {
   display: flex;
   background-color: transparent;
   font-family: 'Open Sans', Arial, sans-serif;
   color: white;
}

h1 {
   font-size: 4.5vh;
   font-weight: 700;
}

h2 {
   font-size: 2.2vh;
   font-weight: normal;
   font-style: italic;
   opacity: 0.8;
}

h3 {
   font-size: 2.2vh;
}

h1,
h2,
h3,
p,
label {
   margin: 0;
   text-shadow: 0 0 1vh rgba(0, 0, 0, 0.15);
}

p {
   font-size: 1.60vh;
}

ul {
   font-size: 1.75vh;
   margin: 0;
   margin-top: 1vh;
   padding-left: 3vh;
}

a {
   color: lightblue;
}

a.install-link {
   text-decoration: none;
}

button {
   border: 0;
   outline: 0;
   color: white;
   background: #8A5AAB;
   padding: 1.2vh 3.5vh;
   margin: auto;
   text-align: center;
   font-family: 'Open Sans', Arial, sans-serif;
   font-size: 2.2vh;
   font-weight: 600;
   cursor: pointer;
   display: block;
   box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
   transition: box-shadow 0.1s ease-in-out;
}

button:hover {
   box-shadow: none;
}

button:active {
   box-shadow: 0 0 0 0.5vh white inset;
}

#addon {
   width: 90vh;
   margin: auto;
   padding-left: 10%;
   padding-right: 10%;
   background: rgba(0, 0, 0, 0.60);
   padding-top: 5%;
   padding-bottom: 5%;
}

.logo {
   height: 14vh;
   width: 14vh;
   margin: auto;
   margin-bottom: 3vh;
}

.logo img {
   width: 100%;
}

.name, .version {
   display: inline-block;
   vertical-align: top;
}

.name {
   line-height: 5vh;
}

.version {
   position: absolute;
   line-height: 5vh;
   margin-left: 1vh;
   opacity: 0.8;
}

.separator {
   margin-bottom: 4vh;
}

.label {
  font-size: 2.2vh;
  font-weight: 600;
  padding: 0;
  line-height: inherit;
}

.input {
  height: 4.5vh;
  width: 100%;
  margin: auto;
  margin-bottom: 10px;
  padding: 6px 12px;
  border-radius: 0;
  outline: 0;
  color: #333;
  background-color: rgb(255, 255, 255);
  box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
  border: 0.5vh solid #8a5aab;
}
</style>
</head>

<body>
   <div id="addon">
      <div class="logo">
         <img src="<%=MANIFEST.logo%>">
      </div>
      <h1 class="name"><%=MANIFEST.name%></h1>
      <h2 class="version"><%=MANIFEST.version%></h2>
      <h2 class="description"><%=MANIFEST.description%></h2>
      <div class="separator"></div>

      <h3 class="gives">This addon has more :</h3>
      <ul>
         <li>Movies</li><li>Series</li><li>TV</li>
      </ul>

      <div class="separator"></div>

      <p>‚ÑπÔ∏è You will need an IPTV subscription in order to use this addon. Free M3U lists are not supported‚ùó<br>

      <div class="separator"></div>

      <label class="label" for="dnsport">DNS:PORT</label>
      <input type="text" id="dnsport" class="input" placeholder="http://url_here.com:port">

      <label class="label" for="username">Username:</label>
      <input type="text" id="username" class="input" placeholder="Your Username">

      <label class="label" for="password">Password:</label>
      <input type="password" id="password" class="input" placeholder="Your Password">

      <label class="label" for="timezone">Time Zone:</label>
      <select id="timezone" class="input">
         <option value="UTC">UTC</option>
         <option value="America/New_York">Eastern Time (ET)</option>
         <option value="America/Chicago">Central Time (CT)</option>
         <option value="America/Denver">Mountain Time (MT)</option>
         <option value="America/Los_Angeles">Pacific Time (PT)</option>
         <option value="Europe/London">London</option>
         <option value="Europe/Paris">Paris</option>
         <option value="Asia/Tokyo">Tokyo</option>
      </select>

      <div class="separator"></div>
         
      <a id="installLink" class="install-link" href="#">
         <button onclick="generateInstallLink()" name="Install">INSTALL</button>
      </a>
      
      <div class="separator"></div>
      
      <div id="installLinkInfo">
         <p>‚ÑπÔ∏è If the installation button doesn't work, you can just paste the generated URL into the Stremio addon search bar:  <a href="https://user-images.githubusercontent.com/1777923/43146711-65a33ccc-8f6a-11e8-978e-4c69640e63e3.png" target="_blank">(Tutorial)</a><br>
            <input type="text" class="input" id="installURL" readonly><button onclick="generateInstallLink(); 
            copy('installURL'); 
            return false;" title="Copy to clipboard">üìã</button></p>
      </div>
                    
      <div class="separator"></div>
   </div>
   <script type="text/javascript">
      function encode(userData) {
         return btoa(JSON.stringify(userData)).replace(/\+/g, '-').replace(/\//g, '_').split('=')[0]
      }

      function copy(id){
         document.getElementById(id).select();
         document.execCommand("copy");
      }

      function generateInstallLink() {
         var BaseURL = $('#dnsport').val().trim() || null;
         var username = $('#username').val().trim() || null;
         var password = $('#password').val().trim() || null;
         var timezone = $('#timezone').val().trim() || 'UTC';

         var params = {username, password, BaseURL, timezone};
         var isParametersValid = true;

         if(params.BaseURL && !params.BaseURL.includes("http") && params.BaseURL.length > 0){
            isParametersValid = false;
            alert("Please indicate http or https status!");
         }

         if(!params.username){
            isParametersValid = false;
            alert("Username is missing!");
         }

         if(!params.password){
            isParametersValid = false;
            alert("Password is missing!");
         }
                    
         if (params.username && params.password && params.BaseURL && isParametersValid) {
            var configuration = encode(params);
            var installLink = document.getElementById('installLink');
            installLink.href = 'stremio://' + window.location.host + '/'  + configuration + '/manifest.json';
            document.getElementById("installURL").value = window.location.protocol + "//" + window.location.host + "/" + configuration + "/manifest.json";
         }
      }
   </script>
</body>
</html>